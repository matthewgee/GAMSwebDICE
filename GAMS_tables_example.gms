SETS
       h   heath             / 1*4 /
       l   liver quality     / 1*5 /
       k   rank              /1*10/
       a   action            /0,1/
       y   signal            /1*4/
       i   Grid Vectors      /1*10/;

Alias
      (h,h1)
      (k,k1)
      (k,k2)
      (k,k3)
      (l,l1)
      (y,y1)
      (i,i1);

SCALAR lambda         daily discount rate;
lambda = 0.999917;

PARAMETERS
             Pi(i,k)        Grid Vectors
             pi_prime(k)    updated Pi's

             v(h,l,i)       value
             v2(h,l,i)      value after one iteration
             vwait          value if action is wait
             x(h,l,i)       policy
             r_TS(h,l)      scaled rewards;

TABLE pH(h,h1) health probability matrix H{h'|h}
       1         2        3        4
1 0.9966    0.0032   0.0000   0.0000
2 0.0005    0.9973   0.0015   0.0000
3 0.0000    0.0031   0.9872   0.0066
4 0.0000    0.0001   0.0056   0.9672;

Table pK(k,k1) rank transition probability matrix K{k'|k}
         1               2               3               4               5               6               7               8               9              10
1 0.906080        0.079090        0.009077        0.003055        0.000933        0.000402        0.000239        0.000420        0.000390        0.000315
2 0.116973        0.667786        0.172183        0.032105        0.007551        0.001527        0.000647        0.000293        0.000432        0.000501
3 0.011606        0.135391        0.612947        0.207797        0.023907        0.004910        0.001718        0.000709        0.000306        0.000709
4 0.002600        0.015762        0.121602        0.661372        0.173916        0.016546        0.004873        0.001717        0.000638        0.000973
5 0.000437        0.003196        0.012090        0.138476        0.654926        0.162426        0.018533        0.006169        0.002334        0.001414
6 0.000151        0.000790        0.002530        0.012178        0.135785        0.639100        0.178318        0.020798        0.008078        0.002273
7 0.000110        0.000342        0.000692        0.003027        0.012824        0.133141        0.636736        0.183712        0.024584        0.004831
8 0.000000        0.000149        0.000337        0.000883        0.003207        0.011691        0.126562        0.649365        0.196324        0.011483
9 0.000000        0.000000        0.000123        0.000217        0.000525        0.001624        0.005919        0.060759        0.813604        0.117228
10 0.000000        0.000000        0.000000        0.000000        0.000000        0.000000        0.000000        0.000251        0.006670        0.993079;

Table pL(k1,l1) liver offer probability matrix L{l'|k'}
         1               2               3               4               5
1 0.275539        0.099973        0.079724        0.027113        0.517651
2 0.233531        0.088320        0.074426        0.025662        0.578061
3 0.198184        0.078081        0.069496        0.024292        0.629946
4 0.153442        0.064411        0.062422        0.022291        0.697435
5 0.105600        0.048642        0.053384        0.019668        0.772706
6 0.066193        0.034243        0.043904        0.016818        0.838841
7 0.036239        0.021756        0.034079        0.013729        0.894197
8 0.015531        0.011474        0.023806        0.010297        0.938892
9 0.002524        0.002750        0.010197        0.005166        0.979364
10 0.000004        0.000011        0.000149        0.000112        0.999724;

Table pO(k1,y1)  O{y'|k'}
         1               2               3               4
1 0.000000        0.000000        0.000011        0.999989
2 0.000000        0.000000        0.001965        0.998035
3 0.000000        0.000000        0.025417        0.974583
4 0.000000        0.000000        0.169813        0.830187
5 0.000000        0.000000        0.581631        0.418369
6 0.000000        0.000000        0.941542        0.058458
7 0.000000        0.000038        0.999240        0.000722
8 0.000000        0.026563        0.973437        0.000000
9 0.000000        0.436372        0.563628        0.000000
10 0.402496        0.596228        0.001276        0.000000;

Table pM(h,k) M{k|h}
         1               2               3               4               5               6               7               8               9              10
1 0.000000        0.000000        0.000000        0.000000        0.000000        0.000000        0.000000        0.000000        0.000000        1.000000
2 0.000000        0.000000        0.000000        0.000000        0.000000        0.000000        0.000000        0.000583        0.034604        0.964813
3 0.000000        0.000000        0.000545        0.008589        0.044163        0.100029        0.151116        0.217229        0.441159        0.037169
4 0.176032        0.131834        0.173449        0.269227        0.201257        0.046620        0.001581        0.000000        0.000000        0.000000;

Table r_t(h,l) unscaled reward r_T{h l}
       1     2     3     4

 1  2233  1985  1837  1645

 2  1992  1785  1647  1485

 3  1754  1577  1465  1325

 4  1517  1373  1277  1135;

r_TS(h,l) = (1-lambda**(r_T(h,l)+1))/(1-lambda);



